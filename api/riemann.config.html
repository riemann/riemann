<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>riemann.config documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Riemann 0.2.7 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>riemann</span></div></div></li><li class="depth-2 branch"><a href="riemann.bin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bin</span></div></a></li><li class="depth-2 branch"><a href="riemann.blueflood.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blueflood</span></div></a></li><li class="depth-2 branch"><a href="riemann.campfire.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>campfire</span></div></a></li><li class="depth-2 branch"><a href="riemann.cloudwatch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cloudwatch</span></div></a></li><li class="depth-2 branch"><a href="riemann.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-2 branch current"><a href="riemann.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="riemann.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="riemann.datadog.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datadog</span></div></a></li><li class="depth-2 branch"><a href="riemann.deps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deps</span></div></a></li><li class="depth-2 branch"><a href="riemann.email.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>email</span></div></a></li><li class="depth-2 branch"><a href="riemann.folds.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>folds</span></div></a></li><li class="depth-2 branch"><a href="riemann.graphite.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graphite</span></div></a></li><li class="depth-2 branch"><a href="riemann.hipchat.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hipchat</span></div></a></li><li class="depth-2 branch"><a href="riemann.index.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>index</span></div></a></li><li class="depth-2 branch"><a href="riemann.influxdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>influxdb</span></div></a></li><li class="depth-2 branch"><a href="riemann.instrumentation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>instrumentation</span></div></a></li><li class="depth-2 branch"><a href="riemann.kairosdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kairosdb</span></div></a></li><li class="depth-2 branch"><a href="riemann.librato.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>librato</span></div></a></li><li class="depth-2 branch"><a href="riemann.logentries.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logentries</span></div></a></li><li class="depth-2 branch"><a href="riemann.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-2 branch"><a href="riemann.logstash.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logstash</span></div></a></li><li class="depth-2 branch"><a href="riemann.mailgun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mailgun</span></div></a></li><li class="depth-2 branch"><a href="riemann.nagios.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nagios</span></div></a></li><li class="depth-2 branch"><a href="riemann.opentsdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opentsdb</span></div></a></li><li class="depth-2 branch"><a href="riemann.opsgenie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opsgenie</span></div></a></li><li class="depth-2 branch"><a href="riemann.pagerduty.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pagerduty</span></div></a></li><li class="depth-2 branch"><a href="riemann.plugin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-2 branch"><a href="riemann.pool.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pool</span></div></a></li><li class="depth-2 branch"><a href="riemann.pubsub.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pubsub</span></div></a></li><li class="depth-2 branch"><a href="riemann.query.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>query</span></div></a></li><li class="depth-2 branch"><a href="riemann.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2 branch"><a href="riemann.service.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>service</span></div></a></li><li class="depth-2 branch"><a href="riemann.shinken.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shinken</span></div></a></li><li class="depth-2 branch"><a href="riemann.slack.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>slack</span></div></a></li><li class="depth-2 branch"><a href="riemann.sns.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sns</span></div></a></li><li class="depth-2 branch"><a href="riemann.stackdriver.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stackdriver</span></div></a></li><li class="depth-2 branch"><a href="riemann.streams.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>streams</span></div></a></li><li class="depth-2 branch"><a href="riemann.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-2"><a href="riemann.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-3"><a href="riemann.time.controlled.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controlled</span></div></a></li><li class="depth-2"><a href="riemann.transport.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transport</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.graphite.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graphite</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.opentsdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opentsdb</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.sse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sse</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.tcp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tcp</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.udp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>udp</span></div></a></li><li class="depth-3"><a href="riemann.transport.websockets.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>websockets</span></div></a></li><li class="depth-2 branch"><a href="riemann.twilio.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>twilio</span></div></a></li><li class="depth-2"><a href="riemann.xymon.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xymon</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="riemann.config.html#var-*config-file*"><div class="inner"><span>*config-file*</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-apply.21"><div class="inner"><span>apply!</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-async-queue.21"><div class="inner"><span>async-queue!</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-clear.21"><div class="inner"><span>clear!</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-config-file-path"><div class="inner"><span>config-file-path</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-core"><div class="inner"><span>core</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-delete-from-index"><div class="inner"><span>delete-from-index</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-depend"><div class="inner"><span>depend</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-graphite"><div class="inner"><span>graphite</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-graphite-server"><div class="inner"><span>graphite-server</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-include"><div class="inner"><span>include</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-index"><div class="inner"><span>index</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-instrumentation"><div class="inner"><span>instrumentation</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-kwargs-or-map"><div class="inner"><span>kwargs-or-map</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-local-repo"><div class="inner"><span>local-repo</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-logstash"><div class="inner"><span>logstash</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-next-core"><div class="inner"><span>next-core</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-opentsdb-server"><div class="inner"><span>opentsdb-server</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-periodically-expire"><div class="inner"><span>periodically-expire</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-publish"><div class="inner"><span>publish</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-read-strings"><div class="inner"><span>read-strings</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-reinject"><div class="inner"><span>reinject</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-repl-server"><div class="inner"><span>repl-server</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-service.21"><div class="inner"><span>service!</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-sse-server"><div class="inner"><span>sse-server</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-start.21"><div class="inner"><span>start!</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-stop.21"><div class="inner"><span>stop!</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-streams"><div class="inner"><span>streams</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-subscribe"><div class="inner"><span>subscribe</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-tcp-server"><div class="inner"><span>tcp-server</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-udp-server"><div class="inner"><span>udp-server</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-update-index"><div class="inner"><span>update-index</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-validate-config"><div class="inner"><span>validate-config</span></div></a></li><li class="depth-1"><a href="riemann.config.html#var-ws-server"><div class="inner"><span>ws-server</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">riemann.config</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-*config-file*"><h3>*config-file*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>The config file currently being included.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L318">view source</a></div></div><div class="public anchor" id="var-apply.21"><h3>apply!</h3><div class="usage"><code>(apply!)</code></div><div class="doc"><div class="markdown"><p>Applies pending changes to the core. Transitions the current core to the next one, and resets the next core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L288">view source</a></div></div><div class="public anchor" id="var-async-queue.21"><h3>async-queue!</h3><div class="usage"><code>(async-queue! name threadpool-service-opts &amp; children)</code></div><div class="doc"><div class="markdown"><p>A stream which registers (using service!) a new threadpool-service with the next core, and returns a stream which accepts events and applies those events to child streams via the threadpool service.</p><p>WARNING: this function is not intended for dynamic use. It creates a new executor service for <em>every</em> invocation. It will not start the executor service until the current configuration is applied. Use sparingly and only at configuration time&ndash;preferably once for each distinct IO-bound asynchronous service.</p><p>See <code>riemann.service/threadpool-service</code> for options.</p><p>Example:</p><p>(let [downstream (batch 100 1/10  (async-queue! :agg {:queue-size 1e3  :core-pool-size 4  :max-pool-size 32}  (forward  (riemann.client/tcp-client  :host &ldquo;127.0.0.1&rdquo;))))]  (streams  &hellip;  ; Forward all events downstream to the aggregator.  (where (service #&ldquo;^riemann.*&rdquo;)  downstream)))</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L231">view source</a></div></div><div class="public anchor" id="var-clear.21"><h3>clear!</h3><div class="usage"><code>(clear!)</code></div><div class="doc"><div class="markdown"><p>Resets the next core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L282">view source</a></div></div><div class="public anchor" id="var-config-file-path"><h3>config-file-path</h3><div class="usage"><code>(config-file-path path)</code></div><div class="doc"><div class="markdown"><p>Computes the full path to a config file. Absolute paths are returned unchanged. Relative paths are expanded relative to <em>config-file</em>. Returns a string.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L322">view source</a></div></div><div class="public anchor" id="var-core"><h3>core</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The currently running core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L53">view source</a></div></div><div class="public anchor" id="var-delete-from-index"><h3>delete-from-index</h3><div class="usage"><code>(delete-from-index)</code><code>(delete-from-index fields)</code></div><div class="doc"><div class="markdown"><p>Deletes any events that pass through from the index. By default, deletes events with the same host and service. If a field, or a list of fields, is given, deletes any events with matching values for all of those fields.</p><p>; Delete all events in the index with the same host (delete-from-index :host event)</p><p>; Delete all events in the index with the same host and state. (delete-from-index [:host :state] event)</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L202">view source</a></div></div><div class="public anchor" id="var-depend"><h3>depend</h3><h4 class="type">macro</h4><div class="usage"><code>(depend plugin artifact version options)</code></div><div class="doc"><div class="markdown"><p>Pull in specified dependencies. This combines pulling dependencies with aether and loading a plugin.</p><p>The option map is fed to com.cemerick.pomegranate/add-dependencies and accepts an optional :exit-on-failure keyword defaulting to true which indicates whether riemann should bail out when failing to load a plugin as well as an option :alias parameter which will be forward to <code>load-plugin</code></p><p>To prefer https, only the clojars repository is registered by default.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L359">view source</a></div></div><div class="public anchor" id="var-graphite"><h3>graphite</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L58">view source</a></div></div><div class="public anchor" id="var-graphite-server"><h3>graphite-server</h3><div class="usage"><code>(graphite-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Add a new Graphite TCP server with opts to the default core.</p><p>(graphite-server {:port 2222})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L135">view source</a></div></div><div class="public anchor" id="var-include"><h3>include</h3><div class="usage"><code>(include path)</code></div><div class="doc"><div class="markdown"><p>Include another config file or directory. If the path points to a  directory, all files with names ending in <code>.config</code> or <code>.clj</code> within  it will be loaded recursively.</p><p>; Relative to the current config file, or cwd (include &ldquo;foo.clj&rdquo;)</p><p>; Absolute path (include &ldquo;/foo/bar.clj&rdquo;)</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L383">view source</a></div></div><div class="public anchor" id="var-index"><h3>index</h3><div class="usage"><code>(index &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Set the index used by this core. Returns the index.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L177">view source</a></div></div><div class="public anchor" id="var-instrumentation"><h3>instrumentation</h3><div class="usage"><code>(instrumentation &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Replaces the default core&rsquo;s instrumentation service with a new one, using the given options. If you prefer not to receive any events about Riemann&rsquo;s well-being, you can pass :enabled? false.</p><p>(instrumentation {:interval 5  :enabled? false})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L116">view source</a></div></div><div class="public anchor" id="var-kwargs-or-map"><h3>kwargs-or-map</h3><div class="usage"><code>(kwargs-or-map opts)</code></div><div class="doc"><div class="markdown"><p>Takes a sequence of arguments like</p><p>[{:foo 2 :bar 3}]
[:foo 2 :bar 3]</p><p>as would be passed to a function taking either kwargs or an options map, and returns an options map.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L61">view source</a></div></div><div class="public anchor" id="var-local-repo"><h3>local-repo</h3><div class="usage"><code>(local-repo path)</code></div><div class="doc"><div class="markdown"><p>Sets the location of the local maven repository used by <code>depend</code> to load plugins</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L353">view source</a></div></div><div class="public anchor" id="var-logstash"><h3>logstash</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L59">view source</a></div></div><div class="public anchor" id="var-next-core"><h3>next-core</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The core which will replace the current core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L55">view source</a></div></div><div class="public anchor" id="var-opentsdb-server"><h3>opentsdb-server</h3><div class="usage"><code>(opentsdb-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Add a new OpenTSDB TCP server with opts to the default core.</p><p>(opentsdb-server {:port 4242})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L142">view source</a></div></div><div class="public anchor" id="var-periodically-expire"><h3>periodically-expire</h3><div class="usage"><code>(periodically-expire)</code><code>(periodically-expire &amp; args)</code></div><div class="doc"><div class="markdown"><p>Sets up a reaper for this core. See riemann.core/reaper.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L217">view source</a></div></div><div class="public anchor" id="var-publish"><h3>publish</h3><div class="usage"><code>(publish channel)</code></div><div class="doc"><div class="markdown"><p>Returns a stream which publishes events to the given channel. Uses this core&rsquo;s pubsub registry.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L262">view source</a></div></div><div class="public anchor" id="var-read-strings"><h3>read-strings</h3><div class="usage"><code>(read-strings string)</code><code>(read-strings forms reader)</code></div><div class="doc"><div class="markdown"><p>Returns a sequence of forms read from string.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L306">view source</a></div></div><div class="public anchor" id="var-reinject"><h3>reinject</h3><div class="usage"><code>(reinject event)</code></div><div class="doc"><div class="markdown"><p>A stream which applies any events it receives back into the current core.</p><p>(with :metric 1 reinject)</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L224">view source</a></div></div><div class="public anchor" id="var-repl-server"><h3>repl-server</h3><div class="usage"><code>(repl-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Starts a new REPL server with opts.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L75">view source</a></div></div><div class="public anchor" id="var-service.21"><h3>service!</h3><div class="usage"><code>(service! service)</code></div><div class="doc"><div class="markdown"><p>Ensures that a given service, or its equivalent, is in the next core. If the current core includes an equivalent service, uses that service instead. Returns the service which will be used in the final core.</p><p>This allows configuration to specify and use services in a way which can, where possible, re-use existing services without interruption&ndash;e.g., when reloading. For example, say you want to use a threadpool executor:</p><p>(let [executor (service! (ThreadPoolExecutor. 1 2 &hellip;))]  (where (service &ldquo;graphite&rdquo;)  (on executor  graph)))</p><p>If you reload this config, the <em>old</em> executor is busily processing messages from the old set of streams. When the new config evaluates (service! &hellip;) it creates a new ThreadPoolExecutor and compares it to the existing core&rsquo;s services. If it&rsquo;s equivalent, service! will re-use the <em>existing</em> executor, which prevents having to shut down the old executor.</p><p>But if you <em>change</em> the dynamics of the new executor somehow&ndash;maybe by adjusting a queue depth or max pool size&ndash;they won&rsquo;t compare as equivalent. When the core transitions, the old executor will be shut down, and the new one used to handle any further graphite events.</p><p>Note: Yeah, this does duplicate some of the work done in core/transition!. No, I&rsquo;m not really sure what to do about it. Maybe we need a named service registry so all lookups are dynamic. :-/</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L80">view source</a></div></div><div class="public anchor" id="var-sse-server"><h3>sse-server</h3><div class="usage"><code>(sse-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Add a new SSE channel server with opts to the default core.</p><p>(sse-server {:port 5556})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L163">view source</a></div></div><div class="public anchor" id="var-start.21"><h3>start!</h3><div class="usage"><code>(start!)</code></div><div class="doc"><div class="markdown"><p>Start the current core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L296">view source</a></div></div><div class="public anchor" id="var-stop.21"><h3>stop!</h3><div class="usage"><code>(stop!)</code></div><div class="doc"><div class="markdown"><p>Stop the current core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L301">view source</a></div></div><div class="public anchor" id="var-streams"><h3>streams</h3><div class="usage"><code>(streams &amp; things)</code></div><div class="doc"><div class="markdown"><p>Add any number of streams to the default core.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L170">view source</a></div></div><div class="public anchor" id="var-subscribe"><h3>subscribe</h3><div class="usage"><code>(subscribe channel f)</code></div><div class="doc"><div class="markdown"><p>Subscribes to the given channel with f, which will receive events. Uses the current core&rsquo;s pubsub registry always, because the next core&rsquo;s registry will be discarded by core/transition.</p><p>Returns a single-arity function that does nothing with its inputs and, when invoked, returns the subscription you created. Why do this weird thing? So you can pretend (subscribe &hellip;) is a stream, and use it in the same context as your other streams, like (publish).</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L269">view source</a></div></div><div class="public anchor" id="var-tcp-server"><h3>tcp-server</h3><div class="usage"><code>(tcp-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Add a new TCP server with opts to the default core.</p><p>(tcp-server {:host &ldquo;localhost&rdquo; :port 5555})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L128">view source</a></div></div><div class="public anchor" id="var-udp-server"><h3>udp-server</h3><div class="usage"><code>(udp-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Add a new UDP server with opts to the default core.</p><p>(udp-server {:port 5555})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L149">view source</a></div></div><div class="public anchor" id="var-update-index"><h3>update-index</h3><div class="usage"><code>(update-index index)</code></div><div class="doc"><div class="markdown"><p>Updates the given index with all events received. Also publishes to the index pubsub channel.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L195">view source</a></div></div><div class="public anchor" id="var-validate-config"><h3>validate-config</h3><div class="usage"><code>(validate-config file)</code></div><div class="doc"><div class="markdown"><p>Check that a config file has valid syntax.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L336">view source</a></div></div><div class="public anchor" id="var-ws-server"><h3>ws-server</h3><div class="usage"><code>(ws-server &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Add a new websockets server with opts to the default core.</p><p>(ws-server {:port 5556})</p></div></div><div class="src-link"><a href="http://github.com/aphyr/riemann/blob/master/src/riemann/config.clj#L156">view source</a></div></div></div></body></html>