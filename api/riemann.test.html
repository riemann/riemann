<!DOCTYPE html PUBLIC ""
    "">

<html><head><meta charset="UTF-8" /><title>riemann.test documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Riemann</span> <span class="project-version">0.3.12</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>riemann</span></div></div></li><li class="depth-2 branch"><a href="riemann.bin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bin</span></div></a></li><li class="depth-2 branch"><a href="riemann.blueflood.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blueflood</span></div></a></li><li class="depth-2 branch"><a href="riemann.boundary.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>boundary</span></div></a></li><li class="depth-2 branch"><a href="riemann.clickhouse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clickhouse</span></div></a></li><li class="depth-2 branch"><a href="riemann.cloudwatch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cloudwatch</span></div></a></li><li class="depth-2 branch"><a href="riemann.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-2 branch"><a href="riemann.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="riemann.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="riemann.datadog.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datadog</span></div></a></li><li class="depth-2 branch"><a href="riemann.deps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deps</span></div></a></li><li class="depth-2 branch"><a href="riemann.druid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>druid</span></div></a></li><li class="depth-2 branch"><a href="riemann.elasticsearch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>elasticsearch</span></div></a></li><li class="depth-2 branch"><a href="riemann.email.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>email</span></div></a></li><li class="depth-2 branch"><a href="riemann.expiration.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>expiration</span></div></a></li><li class="depth-2 branch"><a href="riemann.folds.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>folds</span></div></a></li><li class="depth-2 branch"><a href="riemann.graphite.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graphite</span></div></a></li><li class="depth-2 branch"><a href="riemann.hipchat.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hipchat</span></div></a></li><li class="depth-2 branch"><a href="riemann.index.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>index</span></div></a></li><li class="depth-2 branch"><a href="riemann.influxdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>influxdb</span></div></a></li><li class="depth-2 branch"><a href="riemann.influxdb2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>influxdb2</span></div></a></li><li class="depth-2 branch"><a href="riemann.instrumentation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>instrumentation</span></div></a></li><li class="depth-2 branch"><a href="riemann.kafka.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kafka</span></div></a></li><li class="depth-2 branch"><a href="riemann.kairosdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kairosdb</span></div></a></li><li class="depth-2 branch"><a href="riemann.keenio.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>keenio</span></div></a></li><li class="depth-2 branch"><a href="riemann.librato.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>librato</span></div></a></li><li class="depth-2 branch"><a href="riemann.logentries.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logentries</span></div></a></li><li class="depth-2 branch"><a href="riemann.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-2 branch"><a href="riemann.logstash.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logstash</span></div></a></li><li class="depth-2 branch"><a href="riemann.mailgun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mailgun</span></div></a></li><li class="depth-2 branch"><a href="riemann.msteams.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>msteams</span></div></a></li><li class="depth-2 branch"><a href="riemann.nagios.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nagios</span></div></a></li><li class="depth-2 branch"><a href="riemann.netuitive.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>netuitive</span></div></a></li><li class="depth-2 branch"><a href="riemann.opentsdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opentsdb</span></div></a></li><li class="depth-2 branch"><a href="riemann.opsgenie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opsgenie</span></div></a></li><li class="depth-2 branch"><a href="riemann.pagerduty.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pagerduty</span></div></a></li><li class="depth-2 branch"><a href="riemann.plugin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-2 branch"><a href="riemann.pool.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pool</span></div></a></li><li class="depth-2 branch"><a href="riemann.prometheus.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>prometheus</span></div></a></li><li class="depth-2 branch"><a href="riemann.pubsub.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pubsub</span></div></a></li><li class="depth-2 branch"><a href="riemann.pushover.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pushover</span></div></a></li><li class="depth-2 branch"><a href="riemann.query.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>query</span></div></a></li><li class="depth-2 branch"><a href="riemann.rabbitmq.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rabbitmq</span></div></a></li><li class="depth-2 branch"><a href="riemann.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2 branch"><a href="riemann.service.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>service</span></div></a></li><li class="depth-2 branch"><a href="riemann.shinken.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shinken</span></div></a></li><li class="depth-2 branch"><a href="riemann.slack.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>slack</span></div></a></li><li class="depth-2 branch"><a href="riemann.sns.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sns</span></div></a></li><li class="depth-2 branch"><a href="riemann.stackdriver.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stackdriver</span></div></a></li><li class="depth-2"><a href="riemann.streams.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>streams</span></div></a></li><li class="depth-3"><a href="riemann.streams.pure.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pure</span></div></a></li><li class="depth-2 branch"><a href="riemann.telegram.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>telegram</span></div></a></li><li class="depth-2 branch current"><a href="riemann.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-2"><a href="riemann.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-3"><a href="riemann.time.controlled.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controlled</span></div></a></li><li class="depth-2"><a href="riemann.transport.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transport</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.graphite.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graphite</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.opentsdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>opentsdb</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.rabbitmq.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rabbitmq</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.sse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sse</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.tcp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tcp</span></div></a></li><li class="depth-3 branch"><a href="riemann.transport.udp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>udp</span></div></a></li><li class="depth-3"><a href="riemann.transport.websockets.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>websockets</span></div></a></li><li class="depth-2 branch"><a href="riemann.twilio.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>twilio</span></div></a></li><li class="depth-2 branch"><a href="riemann.victorops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>victorops</span></div></a></li><li class="depth-2 branch"><a href="riemann.xymon.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xymon</span></div></a></li><li class="depth-2"><a href="riemann.zabbix.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>zabbix</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="riemann.test.html#var-*core*"><div class="inner"><span>*core*</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-*results*"><div class="inner"><span>*results*</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-*taps*"><div class="inner"><span>*taps*</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-*testing*"><div class="inner"><span>*testing*</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-deftest"><div class="inner"><span>deftest</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-fresh-results"><div class="inner"><span>fresh-results</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-inject.21"><div class="inner"><span>inject!</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-io"><div class="inner"><span>io</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-lookup"><div class="inner"><span>lookup</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-run-stream"><div class="inner"><span>run-stream</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-run-stream-intervals"><div class="inner"><span>run-stream-intervals</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-tap"><div class="inner"><span>tap</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-tap-stream"><div class="inner"><span>tap-stream</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-test-stream"><div class="inner"><span>test-stream</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-test-stream-intervals"><div class="inner"><span>test-stream-intervals</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-tests"><div class="inner"><span>tests</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-with-test-env"><div class="inner"><span>with-test-env</span></div></a></li><li class="depth-1"><a href="riemann.test.html#var-with-test-stream"><div class="inner"><span>with-test-stream</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">riemann.test</h1><div class="doc"><div class="markdown"><p>Fast, end-to-end, repeatable testing for entire Riemann configs. Provides a <code>tap</code> macro which taps the event stream and (in testing mode) records all events that flow through that stream. Provides a variant of deftest that initiates controlled time and sets up a fresh result set for taps, and a function <code>inject!</code> to apply events to streams and see what each tap received.</p>
</div></div><div class="public anchor" id="var-*core*"><h3>*core*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>The core used in test mode</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L29">view source</a></div></div><div class="public anchor" id="var-*results*"><h3>*results*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A map of tap names to atoms of vectors of captured events.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L22">view source</a></div></div><div class="public anchor" id="var-*taps*"><h3>*taps*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>An atom to a map of tap names to information about the taps; e.g. file and line number, for preventing collisions.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L25">view source</a></div></div><div class="public anchor" id="var-*testing*"><h3>*testing*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Are we currently in test mode?</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L18">view source</a></div></div><div class="public anchor" id="var-deftest"><h3>deftest</h3><h4 class="type">macro</h4><div class="usage"><code>(deftest name &amp; body)</code></div><div class="doc"><div class="markdown"><p>Like clojure.test deftest, but establishes a fresh time context and a fresh set of tap results for the duration of the body.</p>
<pre><code class="language-clojure">(deftest my-tap
  (let [rs (test/inject! [{:time 2 :service "bar"}])]
    (is (= 1 (count (:some-tap rs))))))
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L168">view source</a></div></div><div class="public anchor" id="var-fresh-results"><h3>fresh-results</h3><div class="usage"><code>(fresh-results taps)</code></div><div class="doc"><div class="markdown"><p>Given a map of tap-names to _, builds a map of tap names to atoms of empty vectors, ready to receive events.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L97">view source</a></div></div><div class="public anchor" id="var-inject.21"><h3>inject!</h3><div class="usage"><code>(inject! events)</code><code>(inject! streams events)</code></div><div class="doc"><div class="markdown"><p>Takes a sequence of streams, initiates controlled time and resets the scheduler, applies a sequence of events to those streams, and returns a map of tap names to the events each tap received. Absolutely NOT threadsafe; riemann.time.controlled is global. Streams may be omitted, in which case inject! applies events to the <em>streams</em> dynamic var.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L131">view source</a></div></div><div class="public anchor" id="var-io"><h3>io</h3><h4 class="type">macro</h4><div class="usage"><code>(io &amp; children)</code></div><div class="doc"><div class="markdown"><p>A stream which suppresses side effects in test mode. When <em>testing</em> is true at compile time, returns a function that discards any incoming events. When <em>testing</em> is false, compiles to (sdo child1 child2 …).</p>
<pre><code class="language-clojure">(io
  (fn [e]
    (http/put "http://my.service/callback", {:body (event-&gt;json e)})))
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L82">view source</a></div></div><div class="public anchor" id="var-lookup"><h3>lookup</h3><div class="usage"><code>(lookup events host service)</code></div><div class="doc"><div class="markdown"><p>Lookup an event by host/service in a vector of tapped events returned by inject!. If several matching events have passed through the tap, the last one will be returned.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L155">view source</a></div></div><div class="public anchor" id="var-run-stream"><h3>run-stream</h3><h4 class="type">macro</h4><div class="usage"><code>(run-stream stream inputs)</code></div><div class="doc"><div class="markdown"><p>Applies inputs to stream, and returns outputs.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L206">view source</a></div></div><div class="public anchor" id="var-run-stream-intervals"><h3>run-stream-intervals</h3><h4 class="type">macro</h4><div class="usage"><code>(run-stream-intervals stream inputs-and-intervals)</code></div><div class="doc"><div class="markdown"><p>Applies a seq of alternating events and intervals (in seconds) between them to stream, returning outputs.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L218">view source</a></div></div><div class="public anchor" id="var-tap"><h3>tap</h3><h4 class="type">macro</h4><div class="usage"><code>(tap name &amp; children)</code></div><div class="doc"><div class="markdown"><p>A stream which records inbound events in the <em>results</em> map. Takes a globally unique name which identifies that tap in <em>results</em>.</p>
<p>When <em>testing</em> is false (at compile time!), tap has no effect; it compiles directly into (sdo child-streams).</p>
<p>When <em>testing</em> is true at compile time, tap records any events that arrive in the results map, and passes those events on to its children.</p>
<p>(rate 5 (tap :graph prod-graph-stream))</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L46">view source</a></div></div><div class="public anchor" id="var-tap-stream"><h3>tap-stream</h3><div class="usage"><code>(tap-stream name child)</code></div><div class="doc"><div class="markdown"><p>Called by <code>tap</code> to construct a stream which records events in <em>results</em> before forwarding to child.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L33">view source</a></div></div><div class="public anchor" id="var-test-stream"><h3>test-stream</h3><h4 class="type">macro</h4><div class="usage"><code>(test-stream stream inputs outputs)</code></div><div class="doc"><div class="markdown"><p>Verifies that the given stream, taking inputs, forwards outputs to children.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L238">view source</a></div></div><div class="public anchor" id="var-test-stream-intervals"><h3>test-stream-intervals</h3><h4 class="type">macro</h4><div class="usage"><code>(test-stream-intervals stream inputs-and-intervals outputs)</code></div><div class="doc"><div class="markdown"><p>Verifies that run-stream-intervals, taking inputs/intervals, forwards outputs to children.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L253">view source</a></div></div><div class="public anchor" id="var-tests"><h3>tests</h3><h4 class="type">macro</h4><div class="usage"><code>(tests &amp; body)</code></div><div class="doc"><div class="markdown"><p>Declares a new namespace named <a href="ns">ns</a>-test, requires some clojure.test and riemann.test helpers, and evaluates body in the context of that namespace. Restores the original namespace afterwards.</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L189">view source</a></div></div><div class="public anchor" id="var-with-test-env"><h3>with-test-env</h3><h4 class="type">macro</h4><div class="usage"><code>(with-test-env &amp; body)</code></div><div class="doc"><div class="markdown"><p>Prepares a fresh set of taps, binds <em>testing</em> to true, initiates controlled time and resets the schedulerand runs body in an implicit do. Wrap your entire test suite (including defining the streams themselves) in this macro. Note that you’ll have to use (eval) or (load-file), etc, in order for this to work because the binding takes effect at <em>run time</em>, not <em>compile time</em>–so make your compile time run time and wow this gets confusing.</p>
<pre><code class="language-clojure">(with-test-env
  (eval '(let [s (tap :foo prn)]
           (run-test! [s] [:hi]))))
</code></pre>
<p>prints :hi, and returns {:foo <a href=":hi">:hi</a>}</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L108">view source</a></div></div><div class="public anchor" id="var-with-test-stream"><h3>with-test-stream</h3><h4 class="type">macro</h4><div class="usage"><code>(with-test-stream sym stream inputs outputs)</code></div><div class="doc"><div class="markdown"><p>Exposes a fake index, verifies that the given stream, taking inputs, forwards outputs to children</p>
</div></div><div class="src-link"><a href="https://github.com/riemann/riemann/blob/0.3.12/src/riemann/test.clj#L243">view source</a></div></div></div></body></html>